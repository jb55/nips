
NIP 35
======

Relay-Specific Notes
--------------------

This NIP describes a method for which notes are only valid on the relays that they are specifically destined for. It does this via a fairly extreme measure: adding an additional data to the note-id commitment. This additional data ensures that the note is not valid on existing relays and clients.

New and updated clients/relays that support this will be able to accept and filter notes that are destined for them, enabling many new use cases such as more private relays.

## Modified note commitment

To support relay specific notes, a new JSON field is added to the note called `to`. `to` is a list of strings of relays which the note is destined for. For example:

```json
{
  "pubkey": "...",
  "to": ["wss://relay.jb55.com",""]
}
```

## Calculating the note id

The new note id calculation is like so:

```
[
  1,
  <pubkey, as a lowercase hex string>,
  <created_at, as a number>,
  <kind, as a number>,
  <tags, as an array of arrays of non-null strings>,
  <content, as a string>,
  <to, as an array of non-null strings>,
]
```

## Client validation

Clients SHOULD reject relay-specific notes where the relay it is receiving the note from isn't in the `to` field.

## Server validation

Servers MUST reject relay-specfic notes that are not intended for them by comparing the hostname of the relay to the relays in the `to` field.

